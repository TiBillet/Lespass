{% extends "base.html" %}
{% load static %}
{% load static i18n %}

{% block content %}

<form id="form-nfc" class="hide" hx-post="ask_primary_card" hx-trigger="nfcResult" hx-target="#message-nfc"
	hx-swap="outerHTML" hx-on::after-request="nfc.start()">
	{% csrf_token %}
	<input id="tag-id-cm" name="tag-id-cm" />
</form>

<div id="nfc-container" role="status" aria-label="waiting primary card">
	<h1>{% translate "Attente carte primaire" %}</h1>
	<div id="message-nfc"></div>
</div>

<div id="spinner-container-nfc">
	<div class="spinner-nfc"></div>
</div>
{% endblock content %}

{% block script %}
<script src="{% static 'js/socket.io.3.0.4.js' %}"></script>
<script src="{% static 'js/nfc.js' %}?{{ version }}"></script>

<!-- lance le lecteure nfc -->
<script>
	// lance le lecteur nfc
	document.addEventListener('DOMContentLoaded', () => {
		window.nfc = new NfcReader()
		nfc.start()
	})
</script>
{% endblock script %}


{% block css %}
<style>
	#nfc-container {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		width: 100%;
		height: 100%;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		background-color: var(--noir01);
		color: var(--blanc01);
	}

	.nfc-reader-simu-bt {
		width: 200px;
		height: 70px;
		background-color: var(--bleu04);
		color: var(--blanc01);
		display: flex;
		flex-direction: row;
		justify-content: center;
		align-items: center;
		font-size: 1.5rem;
		margin-bottom: 2rem;
		border-radius: 8px;
		font-weight: bold;
		white-space: pre-line;
		text-align: center;
	}

	#message-nfc {
		flex-direction: row;
		justify-content: center;
		align-items: center;
		font-weight: bold;
		white-space: pre-line;
		text-align: center;
	}

	#spinner-container-nfc {
		position: absolute;
		left: 0;
		top: 0;
		width: 100%;
		height: 100%;
		opacity: 0.5;
		display: flex;
		flex-direction: column;
		justify-content: center;
		align-items: center;
		--spinner-width: 240px;
	}

	.spinner-nfc {
		border: 16px solid var(--noir04);
		border-top: 16px solid var(--vert01);
		border-radius: 50%;
		width: var(--spinner-width);
		height: var(--spinner-width);
		animation: spin 2s linear infinite;
	}

	@keyframes spin {
		0% {
			transform: rotate(0deg);
		}

		100% {
			transform: rotate(360deg);
		}
	}
</style>
{% endblock css %}