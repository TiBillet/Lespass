{% load static %}
{% load static i18n %}

<div id="messages" role="status" aria-label="waiting primary card">
	<h1>{{ message }}</h1>

	<div id="message-nfc"></div>
	<div id="nfc-simu-tag" style="z-index:4;"></div>

	<div id="spinner-container-nfc">
		<div class="spinner-nfc"></div>
	</div>

	<!-- lance le lecteure nfc -->
	<script>
		const form = document.querySelector('#addition-form')
		// change le trigger de form #addition-form pour "nfcResult"
		form.setAttribute('hx-trigger', 'nfcResult')
		// changer l'url du POST
		form.setAttribute('hx-post', 'payment')
		// prend en compte les changement sur le formulaire
		htmx.process(form)
		// ajouter le input r√©ceptionnant le tag_id lue par le lecteur nfc
		document.querySelector('#addition-form').insertAdjacentHTML('afterend', `<input class="addition-include-data" id="nfc-result-tag-id" name="tag_id" />`)
		window.nfc = new NfcReader()
		nfc.start()
	</script>

	<style>
		#messages {
			position: absolute;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			width: 100%;
			height: 100%;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			background-color: var(--noir01);
			color: var(--blanc01);
		}

		.nfc-reader-simu-bt {
			width: 200px;
			height: 70px;
			background-color: var(--bleu04);
			color: var(--blanc01);
			display: flex;
			flex-direction: row;
			justify-content: center;
			align-items: center;
			font-size: 1.5rem;
			margin-bottom: 2rem;
			border-radius: 8px;
			font-weight: bold;
			white-space: pre-line;
			text-align: center;
		}

		#message-nfc {
			flex-direction: row;
			justify-content: center;
			align-items: center;
			font-weight: bold;
			white-space: pre-line;
			text-align: center;
		}

		#spinner-container-nfc {
			position: absolute;
			left: 0;
			top: 0;
			width: 100%;
			height: 100%;
			opacity: 0.5;
			display: flex;
			flex-direction: column;
			justify-content: center;
			align-items: center;
			--spinner-width: 240px;
		}

		.spinner-nfc {
			border: 16px solid var(--noir04);
			border-top: 16px solid var(--vert01);
			border-radius: 50%;
			width: var(--spinner-width);
			height: var(--spinner-width);
			animation: spin 2s linear infinite;
		}

		@keyframes spin {
			0% {
				transform: rotate(0deg);
			}

			100% {
				transform: rotate(360deg);
			}
		}
	</style>

</div>